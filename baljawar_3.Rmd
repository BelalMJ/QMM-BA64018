---
title: "Solve LP Model Using R-Weigelt"
author: "Belal M. Jawarneh"
date: "2025-09-24"
output:
  pdf_document: default
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r}
# ----------------------------
# Step 1: Library Installation and Setup
# ----------------------------

# install.packages("lpSolveAPI") # if not installed
library(lpSolveAPI)
```


```{r}
# ----------------------------
# Step 2: Model Input
# ----------------------------
# Read the pre-defined Linear Programming model from the .lp file.
# The file 'weigelt_model.lp' contains the complete mathematical formulation.
lpmodel <- read.lp("weigelt_model.lp")
```

The complete mathematical formulation of Weigelt's problem-including profit goals and constrains that may affect on the total profit and final decision was translated into a format that R tools can understand. In this step we make coding easier.

```{r}
# ----------------------------
# Step 3: Model Solution
# ----------------------------
# Execute the solver to find the optimal production plan.
# A status of 0 indicates the solver found an optimal solution.
status <- solve(lpmodel)
```
In this step we processed all possible production plans to find the single best one that maximizes profit without breaking any rules. The optimal strategy has been calculated which means no other production plan can yield a higher profit under the given constraints.

```{r}
# ----------------------------
# Step 4: Results Overview
# ----------------------------
# Display the overall success status and the key result: maximum profit.
cat("Solution Status (0 means success):", status, "\n")
cat("Total Maximum Daily Profit: $", format(round(get.objective(lpmodel), 2), big.mark = ","), "\n\n")
```
Interpretation: 

A status of 0 confirms an optimal solution was found successfully. The value \$696,000 is the maximum total profit achievable per day. Which means that the problem is feasible and the primary financial goal is achieved.

For management this is a key financial takeaway. Management now has a clear, data-driven profit target ($696,000 daily) to expect from the new product line, which is crucial for forecasting and reporting.

```{r}
# ----------------------------
# Step 5: Extract and Present Optimal Solution
# ----------------------------
# Retrieve the values of the decision variables (x1 to x9).
solution <- get.variables(lpmodel)


# Format the solution into a readable table showing the optimal number of units to produce for each size at each plant.
production_plan <- data.frame(
  Variable = paste0("x", 1:9),
  Plant = rep(c("Plant 1", "Plant 2", "Plant 3"), 3),
  Size = rep(c("Large", "Medium", "Small"), each = 3),
  Units_Produced = round(solution, 2)
)

cat("Optimal Production Plan:\n")
print(production_plan, row.names = FALSE)
```

Interpretation: 

This step compute the precise optimal production plan. It shows a strategy of plant specialization: Plant 1 makes Large/Medium units, Plant 2 makes Medium/Small units, and Plant 3 makes only Small units.

In other words, this plan makes the most efficient use of each plant's unique resources (capacity and storage space) to maximize profitability.

Management now clearly can decide to direct Plant 1 to produce 517 large and 178 medium units daily, Plant 2 to produce 667 medium and 167 small units daily, and Plant 3 to produce 417 small units daily. 


```{r}
# ----------------------------
# Step 6: Validation of Key Constraint
# ----------------------------
# Verify that the critical "same percentage of capacity" managerial constraint is satisfied by the solution.
cat("\nValidation: Total Production by Plant (and % of Capacity Used):\n")

# Calculate total production per plant (x1+x4+x7, x2+x5+x8, x3+x6+x9)
totals <- c(
  sum(solution[c(1,4,7)]), # Plant 1 total
  sum(solution[c(2,5,8)]), # Plant 2 total
  sum(solution[c(3,6,9)])  # Plant 3 total
)

# Plant capacities from the problem statement
capacity <- c(750, 900, 450)

# Calculate the percentage of capacity used at each plant
percentage_used <- totals / capacity * 100

# Create a validation table
validation_df <- data.frame(
  Plant = c("Plant 1", "Plant 2", "Plant 3"),
  Production = round(totals, 2),
  Capacity = capacity,
  PercentUsed = round(percentage_used, 2)
)

# Print the validation results
print(validation_df, row.names = FALSE)

```



Interpretation: 

Which means that the critical managerial constraint to use the same percentage of capacity at each plant has been perfectly satisfied. The calculation is: (694.44 / 750) * 100 = 92.59%, (833.33 / 900) * 100 = 92.59%, (416.67 / 450) * 100 = 92.59%. This satisfies the layoff-avoidance policy perfectly. The workload is balanced proportionally across all plants.

Now management can communicate with confidence that this plan will not result in a disproportionate layoff at any single plant. This is crucial for workforce planning, maintaining morale, and ensuring equitable implementation of the new product line across all branches. The plan is not only profitable but also fair.


But wait, does that mean the optimal solution should be applied as is? Is it guaranteed?

As we noticed in the previous discussions, the model provides an optimal mathematical solution, but real-world factors like demand changes, supply chain disruptions, or labor availability may require adjustments. This means the plan should be treated as a strong guideline, not a rigid rule, with management retaining flexibility to adapt if conditions shift.

For example, the optimal solution recommends producing fractional units, such as 516.67 large panels at Plant 1. Since it's impossible to produce a fraction of a product in reality, this solution must be adjusted by rounding these numbers to the nearest whole integer. This adjustment may cause a very slight deviation from the perfect 92.59% capacity use and the ideal $696,000 profit, but it will provide a practical and implementable production plan for management.